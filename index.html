<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="it"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;🎯 Lead Recovery System - Romina Pipeline&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>* { margin: 0; padding: 0; box-sizing: border-box; }</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>body {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #667eea, #764ba2);</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 1600px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.header {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 30px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.tabs {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 25px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab {</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex: 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: transparent;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab.active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #667eea, #764ba2);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab-content.active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.today-stats {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #667eea, #764ba2);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Pipeline Styles */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.pipeline-container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">            </span>grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 30px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.pipeline-column {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 25px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 500px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.column-header {</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.column-header .count {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: -5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: -5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255,255,255,0.9);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.nuovo .column-header { background: #3498db; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.non-risponde .column-header { background: #f39c12; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.non-risponde-2 .column-header { background: #e67e22; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.non-risponde-3 .column-header { background: #d35400; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.mai-reperibile .column-header { background: #95a5a6; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.non-interessato .column-header { background: #e74c3c; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-ok .column-header { background: #27ae60; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.pipeline-lead {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #e9ecef;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: grab;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.pipeline-lead:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 15px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #3498db;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.pipeline-lead.dragging {</p>
<p class="p1"><span class="Apple-converted-space">            </span>opacity: 0.7;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: rotate(5deg);</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: grabbing;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.pipeline-column.drag-over {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #e3f2fd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px dashed #3498db;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-name {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 5px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-email {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #666;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 5px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-commercial {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #f39c12;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 8px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-timestamp {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.7em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #95a5a6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-top: 1px solid #eee;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding-top: 5px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-notes {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #fff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 4px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>resize: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.auto-log {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #fff3cd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #ffeaa7;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 4px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.7em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #856404;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Lead detail modal */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 1000;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(0,0,0,0.5);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 5% auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 90%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 600px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-height: 80vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow-y: auto;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal-header {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: space-between;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: 2px solid #eee;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.close {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 28px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #999;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.close:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.timeline {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.timeline-item {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-left: 4px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.timeline-time {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #666;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-width: 120px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.timeline-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex: 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-left: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.timeline-action {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Traditional list view */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.lead-list {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 25px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.search-box {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 12px 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 16px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-buttons {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 8px 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: scale(1.05);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 15px rgba(0,0,0,0.2);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.nuovo { background: #3498db; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.non-risponde { background: #f39c12; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.non-risponde-2 { background: #e67e22; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.non-risponde-3 { background: #d35400; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.mai-reperibile { background: #95a5a6; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.non-interessato { background: #e74c3c; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.lead-ok { background: #27ae60; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.filter-btn.tutti { background: #34495e; color: white; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.main-content {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">            </span>grid-template-columns: 1fr 350px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.sidebar {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 25px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: fit-content;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-group label {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #555;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-group input, .form-group select {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 14px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-primary {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #3498db;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 12px 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 16px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-primary:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #2980b9;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-success {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #27ae60;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 14px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-success:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #229954;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Import styles */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.import-area {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px dashed #ddd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.import-area:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #3498db;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #e3f2fd;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.import-area.dragover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #27ae60;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #e8f5e8;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.file-input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.report-section {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 25px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.success-message {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #d4edda;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #155724;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #c3e6cb;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.error-message {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8d7da;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #721c24;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #f5c6cb;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>@media (max-width: 768px) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>.pipeline-container {</p>
<p class="p1"><span class="Apple-converted-space">                </span>grid-template-columns: 1fr;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>.main-content {</p>
<p class="p1"><span class="Apple-converted-space">                </span>grid-template-columns: 1fr;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>.tabs {</p>
<p class="p1"><span class="Apple-converted-space">                </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>/* Report responsive design */</p>
<p class="p1"><span class="Apple-converted-space">            </span>div[style*="grid-template-columns: 1fr 1fr 1fr"] {</p>
<p class="p1"><span class="Apple-converted-space">                </span>grid-template-columns: 1fr !important;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>div[style*="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr))"] {</p>
<p class="p1"><span class="Apple-converted-space">                </span>grid-template-columns: repeat(2, 1fr) !important;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.hidden {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Header --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h1&gt;🎯 Lead Recovery System&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2&gt;Dashboard Pipeline Romina - Drag &amp; Drop&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Tabs --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="tabs"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="tab active" onclick="showTab('pipeline')"&gt;🔄 Pipeline&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="tab" onclick="showTab('dashboard')"&gt;📊 Lista Lead&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="tab" onclick="showTab('import')"&gt;📤 Import Lead&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="tab" onclick="showTab('reports')"&gt;📈 Report Chiamate&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Pipeline Tab --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="pipeline-tab" class="tab-content active"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Today Stats --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="today-stats"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;📊 OGGI: &lt;span id="today-calls"&gt;8&lt;/span&gt; chiamate fatte | &lt;span id="today-ok"&gt;3&lt;/span&gt; Lead Ok | &lt;span id="today-closed"&gt;2&lt;/span&gt; Chiusi&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;💡 &lt;strong&gt;Trascina i lead&lt;/strong&gt; tra le colonne per cambiare stato - il sistema registra automaticamente orario e data!&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Pipeline Columns --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="pipeline-container" id="pipeline-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Columns will be generated by JavaScript --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Dashboard Tab --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="dashboard-tab" class="tab-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Search and Filters --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="lead-list"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;📋 Lista Lead Tradizionale&lt;/h3&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="text" class="search-box" placeholder="🔍 Cerca per nome, email o commerciale..." id="search-input"&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="filter-buttons"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn tutti active" onclick="filterLeads('tutti')"&gt;Tutti&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn nuovo" onclick="filterLeads('nuovo')"&gt;🆕 Nuovo&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn non-risponde" onclick="filterLeads('non-risponde')"&gt;📞 Non risponde&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn non-risponde-2" onclick="filterLeads('non-risponde-2')"&gt;📞📞 Non risponde 2&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn non-risponde-3" onclick="filterLeads('non-risponde-3')"&gt;📞📞📞 Non risponde 3&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn mai-reperibile" onclick="filterLeads('mai-reperibile')"&gt;❌ Mai reperibile&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn non-interessato" onclick="filterLeads('non-interessato')"&gt;💔 Non interessato&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="filter-btn lead-ok" onclick="filterLeads('lead-ok')"&gt;✅ Lead Ok&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Lead Items --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="leads-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Lead items will be populated by JavaScript --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Import Tab --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="import-tab" class="tab-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="report-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2&gt;📤 Import Massivo Lead&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="margin-bottom: 20px;"&gt;Carica i tuoi lead da file CSV o Excel. Il sistema riconoscerà automaticamente le colonne: Nome, Cognome, Email.&lt;/p&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="import-messages"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="import-area" id="import-area" onclick="document.getElementById('file-input').click()"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;i class="fas fa-cloud-upload-alt" style="font-size: 3em; color: #3498db; margin-bottom: 15px;"&gt;&lt;/i&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3&gt;📁 Trascina qui il tuo file o clicca per selezionare&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;Supportati: CSV, XLSX, XLS&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p style="color: #666; font-size: 0.9em; margin-top: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Formato atteso: Nome | Cognome | Email&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>(le colonne verranno riconosciute automaticamente)</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="file" id="file-input" class="file-input" accept=".csv,.xlsx,.xls" onchange="handleFileSelect(event)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="preview-container" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3&gt;👀 Anteprima Dati&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="preview-table" style="margin: 15px 0;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="btn-primary" onclick="confirmImport()"&gt;✅ Conferma Import&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="btn-primary" onclick="cancelImport()" style="background: #e74c3c; margin-top: 10px;"&gt;❌ Annulla&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="margin-top: 30px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3&gt;➕ Aggiungi Singolo Lead&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;form id="add-lead-form"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label&gt;Nome&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="nome" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label&gt;Cognome&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="cognome" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label&gt;Email&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="email" id="email" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button type="submit" class="btn-primary"&gt;🚀 Aggiungi Lead&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/form&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Reports Tab --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="reports-tab" class="tab-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="report-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2&gt;📈 Dashboard Report Completo&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="margin-bottom: 20px;"&gt;Monitoraggio performance e attività di Romina con metriche avanzate.&lt;/p&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- KPI Dashboard --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px; text-align: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 2.5em; font-weight: bold; margin-bottom: 5px;" id="total-leads"&gt;0&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 0.9em;"&gt;📊 Lead Totali&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 20px; border-radius: 12px; text-align: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 2.5em; font-weight: bold; margin-bottom: 5px;" id="recovery-rate-percent"&gt;0%&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 0.9em;"&gt;✅ Tasso Recupero&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: linear-gradient(45deg, #f39c12, #e67e22); color: white; padding: 20px; border-radius: 12px; text-align: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 2.5em; font-weight: bold; margin-bottom: 5px;" id="avg-daily-calls"&gt;0&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 0.9em;"&gt;📞 Media Chiamate/Giorno&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: linear-gradient(45deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 12px; text-align: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 2.5em; font-weight: bold; margin-bottom: 5px;" id="active-leads"&gt;0&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-size: 0.9em;"&gt;🔄 Lead Attivi&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Three Column Layout --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px;"&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Column 1: Performance Metrics --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.1);"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 style="color: #2c3e50; margin-bottom: 15px; border-bottom: 2px solid #3498db; padding-bottom: 10px;"&gt;📊 Performance Romina&lt;/h3&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-bottom: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; margin-bottom: 5px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;🎯 Lead Recuperati&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;strong id="recovered-leads"&gt;0&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="background: #ecf0f1; border-radius: 10px; height: 8px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div id="recovery-bar" style="background: #27ae60; height: 8px; border-radius: 10px; width: 0%; transition: width 0.5s ease;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-bottom: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; margin-bottom: 5px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;📞 Chiamate Questa Settimana&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;strong id="week-calls"&gt;0&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="background: #ecf0f1; border-radius: 10px; height: 8px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div id="calls-bar" style="background: #f39c12; height: 8px; border-radius: 10px; width: 0%; transition: width 0.5s ease;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-bottom: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; margin-bottom: 5px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;⏱️ Tempo Medio Recupero&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;strong id="avg-recovery-time"&gt;0 giorni&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-bottom: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; margin-bottom: 5px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;🏆 Best Day Performance&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;strong id="best-day"&gt;N/A&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Column 2: Pipeline Status --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.1);"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 style="color: #2c3e50; margin-bottom: 15px; border-bottom: 2px solid #e74c3c; padding-bottom: 10px;"&gt;🔄 Stato Pipeline&lt;/h3&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="pipeline-stats"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Will be populated by JavaScript --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h4 style="color: #2c3e50; margin-bottom: 10px;"&gt;💡 Insights&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="pipeline-insights" style="font-size: 0.9em; color: #666;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Dynamic insights will be populated --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Column 3: Weekly Trends --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.1);"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 style="color: #2c3e50; margin-bottom: 15px; border-bottom: 2px solid #27ae60; padding-bottom: 10px;"&gt;📈 Trend Settimanali&lt;/h3&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-bottom: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Lunedì&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="display: flex; align-items: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div style="width: 100px; height: 6px; background: #ecf0f1; border-radius: 3px; margin-right: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div id="mon-bar" style="height: 6px; background: #3498db; border-radius: 3px; width: 20%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span id="mon-calls" style="font-size: 0.8em; color: #666;"&gt;5&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Martedì&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="display: flex; align-items: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div style="width: 100px; height: 6px; background: #ecf0f1; border-radius: 3px; margin-right: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div id="tue-bar" style="height: 6px; background: #3498db; border-radius: 3px; width: 45%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span id="tue-calls" style="font-size: 0.8em; color: #666;"&gt;12&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Mercoledì&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="display: flex; align-items: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div style="width: 100px; height: 6px; background: #ecf0f1; border-radius: 3px; margin-right: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div id="wed-bar" style="height: 6px; background: #3498db; border-radius: 3px; width: 80%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span id="wed-calls" style="font-size: 0.8em; color: #666;"&gt;18&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Giovedì&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="display: flex; align-items: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div style="width: 100px; height: 6px; background: #ecf0f1; border-radius: 3px; margin-right: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div id="thu-bar" style="height: 6px; background: #3498db; border-radius: 3px; width: 60%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span id="thu-calls" style="font-size: 0.8em; color: #666;"&gt;15&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Venerdì&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="display: flex; align-items: center;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div style="width: 100px; height: 6px; background: #ecf0f1; border-radius: 3px; margin-right: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div id="fri-bar" style="height: 6px; background: #3498db; border-radius: 3px; width: 90%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span id="fri-calls" style="font-size: 0.8em; color: #666;"&gt;22&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="margin-top: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; border-left: 4px solid #27ae60;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="font-weight: bold; color: #27ae60; margin-bottom: 5px;"&gt;🚀 Obiettivo Settimanale&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="display: flex; justify-content: space-between;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;80 chiamate&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span id="weekly-progress" style="color: #27ae60; font-weight: bold;"&gt;72/80&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="background: #c8e6c9; border-radius: 10px; height: 6px; margin-top: 5px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="background: #27ae60; height: 6px; border-radius: 10px; width: 90%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Daily Activity Timeline --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-bottom: 30px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3 style="color: #2c3e50; margin-bottom: 15px;"&gt;📅 Timeline Attività Giornaliere&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="daily-reports"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Daily reports will be populated by JavaScript --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Export Actions --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="btn-success" onclick="exportLeadOk()"&gt;📤 Esporta Lead Ok&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="btn-success" onclick="exportAllLeads()"&gt;📋 Esporta Tutti Lead&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="btn-success" onclick="exportActivityLog()"&gt;📊 Esporta Log Attività&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button class="btn-success" onclick="exportWeeklyReport()"&gt;📈 Esporta Report Settimanale&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Monthly Management --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 12px; padding: 20px; margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3 style="color: #856404; margin-bottom: 15px;"&gt;🗓️ Gestione Fine Mese&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p style="color: #856404; margin-bottom: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Strumenti per archiviare i lead completati e preparare il sistema per il nuovo ciclo mensile.</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/p&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="btn-primary" onclick="showArchiveOptions()" style="background: #f39c12;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>📦 Archivia Lead Completati</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="btn-primary" onclick="showCleanupOptions()" style="background: #e74c3c;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>🧹 Pulizia Sistema</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="btn-primary" onclick="exportMonthlyReport()" style="background: #9b59b6;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>📊 Report Mensile Completo</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Archive Modal would be here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Lead Detail Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="leadModal" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2 id="modal-lead-name"&gt;Dettagli Lead&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="close" onclick="closeModal()"&gt;&amp;times;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="modal-lead-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Lead details will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Archive Options Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="archiveModal" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2&gt;📦 Archiviazione Lead Completati&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="close" onclick="closeArchiveModal()"&gt;&amp;times;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;Seleziona quali lead completati vuoi archiviare per preparare il sistema al nuovo ciclo:&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="archive-summary" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Summary will be populated --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h4&gt;Opzioni di Archiviazione:&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="archive-lead-ok" checked&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;✅ Lead Ok (inviati ai commerciali)&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="archive-non-interessato" checked&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;💔 Non interessati&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="archive-mai-reperibile" checked&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;❌ Mai reperibili&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="export-before-archive" checked&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;📤 Esporta prima di archiviare&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display: flex; gap: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button class="btn-primary" onclick="executeArchive()" style="background: #f39c12;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>📦 Conferma Archiviazione</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button class="btn-primary" onclick="closeArchiveModal()" style="background: #95a5a6;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>❌ Annulla</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Cleanup Options Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="cleanupModal" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2&gt;🧹 Pulizia Sistema&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="close" onclick="closeCleanupModal()"&gt;&amp;times;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="color: #e74c3c; font-weight: bold;"&gt;⚠️ ATTENZIONE: Queste operazioni sono irreversibili!&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;Seleziona cosa vuoi eliminare definitivamente dal sistema:&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h4&gt;Opzioni di Pulizia:&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="cleanup-all-leads"&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;🗑️ Elimina TUTTI i lead&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="cleanup-activity-log"&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;📊 Pulisci log attività&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label style="display: block; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" id="export-before-cleanup" checked&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span style="margin-left: 8px;"&gt;📤 Esporta tutto prima di eliminare&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="color: #856404;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>💡 &lt;strong&gt;Consiglio:&lt;/strong&gt; Esegui sempre un backup completo prima della pulizia.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>Dopo la pulizia potrai importare i nuovi 1000 lead del mese.</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display: flex; gap: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button class="btn-primary" onclick="executeCleanup()" style="background: #e74c3c;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>🧹 Conferma Pulizia</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button class="btn-primary" onclick="closeCleanupModal()" style="background: #95a5a6;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>❌ Annulla</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Enhanced data structure with activity tracking - SISTEMA VUOTO PRONTO PER USO</p>
<p class="p1"><span class="Apple-converted-space">        </span>let leads = [</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Sistema vuoto - pronto per import dei tuoi lead</p>
<p class="p1"><span class="Apple-converted-space">        </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let currentFilter = 'tutti';</p>
<p class="p1"><span class="Apple-converted-space">        </span>let pendingImportData = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Status configurations</p>
<p class="p1"><span class="Apple-converted-space">        </span>const statusConfig = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>'nuovo': { label: '🆕 Nuovo', color: '#3498db' },</p>
<p class="p1"><span class="Apple-converted-space">            </span>'non-risponde': { label: '📞 Non risponde', color: '#f39c12' },</p>
<p class="p1"><span class="Apple-converted-space">            </span>'non-risponde-2': { label: '📞📞 Non risponde 2', color: '#e67e22' },</p>
<p class="p1"><span class="Apple-converted-space">            </span>'non-risponde-3': { label: '📞📞📞 Non risponde 3', color: '#d35400' },</p>
<p class="p1"><span class="Apple-converted-space">            </span>'mai-reperibile': { label: '❌ Mai reperibile', color: '#95a5a6' },</p>
<p class="p1"><span class="Apple-converted-space">            </span>'non-interessato': { label: '💔 Non interessato', color: '#e74c3c' },</p>
<p class="p1"><span class="Apple-converted-space">            </span>'lead-ok': { label: '✅ Lead Ok', color: '#27ae60' }</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>const commerciali = [</p>
<p class="p1"><span class="Apple-converted-space">            </span>"Luca Bianchi",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"Maria Rossi",<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>"Giuseppe Verde",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"Anna Neri",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"Paolo Romano",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"Silvia Blu"</p>
<p class="p1"><span class="Apple-converted-space">        </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showTab(tabName) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Hide all tab contents</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.tab-content').forEach(content =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>content.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Remove active class from all tabs</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.tab').forEach(tab =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>tab.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Show selected tab content</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(tabName + '-tab').classList.add('active');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Add active class to clicked tab</p>
<p class="p1"><span class="Apple-converted-space">            </span>event.target.classList.add('active');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Load specific content for each tab</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (tabName === 'pipeline') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (tabName === 'dashboard') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (tabName === 'reports') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderReports();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function renderPipeline() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById('pipeline-container');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const statusKeys = Object.keys(statusConfig);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = statusKeys.map(status =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const leadsInStatus = leads.filter(lead =&gt; lead.stato === status);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>return `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="pipeline-column ${status}" data-status="${status}" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="column-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${statusConfig[status].label}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="count"&gt;${leadsInStatus.length}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="column-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${leadsInStatus.map(lead =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="pipeline-lead" draggable="true" data-lead-id="${lead.id}" ondragstart="drag(event)" onclick="showLeadDetail(${lead.id})"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="lead-name"&gt;${lead.nome} ${lead.cognome}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="lead-email"&gt;📧 ${lead.email}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>${lead.commerciale ? `&lt;div class="lead-commercial"&gt;👤 ${lead.commerciale}&lt;/div&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;textarea class="lead-notes" placeholder="Note..." onchange="updateLeadNotes(${lead.id}, this.value)" onclick="event.stopPropagation()"&gt;${lead.note}&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>${lead.attivita.length &gt; 0 ? `</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div class="auto-log"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>🕒 Ultima: ${formatTimestamp(lead.attivita[lead.attivita.length - 1].timestamp)}</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>` : ''}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>`).join('')}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}).join('');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateStats();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function renderLeads() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById('leads-container');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const searchTerm = document.getElementById('search-input').value.toLowerCase();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let filteredLeads = leads.filter(lead =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const matchesFilter = currentFilter === 'tutti' || lead.stato === currentFilter;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const matchesSearch = searchTerm === '' ||<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.nome.toLowerCase().includes(searchTerm) ||</p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.cognome.toLowerCase().includes(searchTerm) ||</p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.email.toLowerCase().includes(searchTerm) ||</p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.commerciale.toLowerCase().includes(searchTerm);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>return matchesFilter &amp;&amp; matchesSearch;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = filteredLeads.map(lead =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="border: 1px solid #eee; border-radius: 8px; padding: 15px; margin-bottom: 10px; background: white;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="font-weight: bold; font-size: 1.1em;"&gt;${lead.nome} ${lead.cognome}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="padding: 4px 12px; border-radius: 15px; font-size: 0.8em; font-weight: bold; color: white; background: ${statusConfig[lead.stato].color}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${statusConfig[lead.stato].label}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="font-size: 0.9em; color: #666; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>📧 ${lead.email}&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>${lead.commerciale ? `👤 Commerciale: ${lead.commerciale}` : '👤 &lt;em&gt;Commerciale non assegnato&lt;/em&gt;'}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label style="font-size: 0.8em;"&gt;Assegna:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;select onchange="assignCommercial(${lead.id}, this.value)" style="padding: 5px; border: 1px solid #ddd; border-radius: 5px; font-size: 0.8em;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Seleziona commerciale&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${commerciali.map(comm =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;option value="${comm}" ${lead.commerciale === comm ? 'selected' : ''}&gt;${comm}&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>`).join('')}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;textarea style="width: 100%; margin-top: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 0.9em; resize: vertical; min-height: 60px;" placeholder="💭 Note per il commerciale..." onchange="updateLeadNotes(${lead.id}, this.value)"&gt;${lead.note}&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showLeadDetail(${lead.id})" style="background: #3498db; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px;"&gt;📋 Vedi Timeline&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`).join('');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateStats();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateStats() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const stats = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>Object.keys(statusConfig).forEach(status =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>stats[status] = leads.filter(lead =&gt; lead.stato === status).length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update today's stats</p>
<p class="p1"><span class="Apple-converted-space">            </span>const today = new Date().toDateString();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const todayActivities = leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.filter(a =&gt; new Date(a.timestamp).toDateString() === today &amp;&amp; a.azione === 'Chiamata effettuata')</p>
<p class="p1"><span class="Apple-converted-space">            </span>);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('today-calls').textContent = todayActivities.length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('today-ok').textContent = todayActivities.filter(a =&gt; a.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('today-closed').textContent = todayActivities.filter(a =&gt; a.stato === 'non-interessato' || a.stato === 'mai-reperibile').length;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Drag and drop functions</p>
<p class="p1"><span class="Apple-converted-space">        </span>function allowDrop(ev) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.currentTarget.classList.add('drag-over');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function dragLeave(ev) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.currentTarget.classList.remove('drag-over');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function drag(ev) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.dataTransfer.setData("text", ev.target.getAttribute('data-lead-id'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.target.classList.add('dragging');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function drop(ev) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>ev.currentTarget.classList.remove('drag-over');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const leadId = parseInt(ev.dataTransfer.getData("text"));</p>
<p class="p1"><span class="Apple-converted-space">            </span>const newStatus = ev.currentTarget.getAttribute('data-status');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lead = leads.find(l =&gt; l.id === leadId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (lead &amp;&amp; lead.stato !== newStatus) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Add automatic activity log</p>
<p class="p1"><span class="Apple-converted-space">                </span>const now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">                </span>const dettagli = `Cambiato stato da "${statusConfig[lead.stato].label}" a "${statusConfig[newStatus].label}" - ${formatTime(now)}`;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>azione: 'Chiamata effettuata',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>stato: newStatus,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>timestamp: now.toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>automatico: true,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>dettagli: dettagli</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.stato = newStatus;</p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.ultimaChiamata = now.toISOString();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Remove dragging class from all elements</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.pipeline-lead').forEach(el =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>el.classList.remove('dragging');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatTimestamp(timestamp) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const date = new Date(timestamp);</p>
<p class="p1"><span class="Apple-converted-space">            </span>return `${date.toLocaleDateString('it-IT')} ${date.toLocaleTimeString('it-IT', {hour: '2-digit', minute: '2-digit'})}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatTime(date) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return date.toLocaleTimeString('it-IT', {hour: '2-digit', minute: '2-digit'});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showLeadDetail(leadId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lead = leads.find(l =&gt; l.id === leadId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!lead) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('modal-lead-name').textContent = `${lead.nome} ${lead.cognome}`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const modalContent = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="margin-bottom: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;📧 Email:&lt;/strong&gt; ${lead.email}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;👤 Commerciale:&lt;/strong&gt; ${lead.commerciale || 'Non assegnato'}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;📊 Stato attuale:&lt;/strong&gt; &lt;span style="background: ${statusConfig[lead.stato].color}; color: white; padding: 4px 8px; border-radius: 4px;"&gt;${statusConfig[lead.stato].label}&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;📝 Note:&lt;/strong&gt; ${lead.note || 'Nessuna nota'}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="timeline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h4&gt;📈 Timeline Attività&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>${lead.attivita.slice().reverse().map(attivita =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="timeline-item" style="border-left-color: ${statusConfig[attivita.stato].color}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="timeline-time"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>${formatTimestamp(attivita.timestamp)}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="timeline-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="timeline-action"&gt;${attivita.azione}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div style="color: #666; font-size: 0.9em;"&gt;${attivita.dettagli}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>`).join('')}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('modal-lead-content').innerHTML = modalContent;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('leadModal').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('leadModal').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateLeadNotes(leadId, notes) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lead = leads.find(l =&gt; l.id === leadId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (lead) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.note = notes;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (notes.trim()) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.attivita.push({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>azione: 'Nota aggiunta',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>stato: lead.stato,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>timestamp: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>automatico: true,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>dettagli: `Nota aggiunta: "${notes.substring(0, 50)}${notes.length &gt; 50 ? '...' : ''}"`</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function assignCommercial(leadId, commercial) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lead = leads.find(l =&gt; l.id === leadId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (lead) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const oldCommercial = lead.commerciale;</p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.commerciale = commercial;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (commercial &amp;&amp; commercial !== oldCommercial) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.attivita.push({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>azione: 'Commerciale assegnato',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>stato: lead.stato,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>timestamp: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>automatico: true,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>dettagli: `Commerciale assegnato: ${commercial}${oldCommercial ? ` (precedente: ${oldCommercial})` : ''}`</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function filterLeads(filter) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentFilter = filter;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update active filter button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.filter-btn').forEach(btn =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>btn.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>event.target.classList.add('active');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function addNewLead() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const newLead = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>id: Date.now(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>nome: document.getElementById('nome').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>cognome: document.getElementById('cognome').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>email: document.getElementById('email').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>commerciale: '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>stato: 'nuovo',</p>
<p class="p1"><span class="Apple-converted-space">                </span>note: '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>dataCreazione: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>ultimaChiamata: null,</p>
<p class="p1"><span class="Apple-converted-space">                </span>attivita: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{</p>
<p class="p1"><span class="Apple-converted-space">                        </span>azione: 'Creazione lead',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>stato: 'nuovo',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>timestamp: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>automatico: true,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>dettagli: 'Lead creato manualmente nel sistema'</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>leads.unshift(newLead);</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('add-lead-form').reset();</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// File import functions (same as before)</p>
<p class="p1"><span class="Apple-converted-space">        </span>function handleFileSelect(event) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const file = event.target.files[0];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (file) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>processFile(file);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function processFile(file) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const fileExtension = file.name.split('.').pop().toLowerCase();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>reader.onload = function(e) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let data;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (fileExtension === 'csv') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>data = parseCSV(e.target.result);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (fileExtension === 'xlsx' || fileExtension === 'xls') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>data = parseExcel(e.target.result);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>showMessage('Formato file non supportato. Usa CSV, XLSX o XLS.', 'error');</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (data &amp;&amp; data.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>showPreview(data);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>showMessage('Nessun dato trovato nel file.', 'error');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>showMessage('Errore nella lettura del file: ' + error.message, 'error');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (fileExtension === 'csv') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.readAsText(file);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.readAsArrayBuffer(file);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function parseCSV(csvText) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lines = csvText.split('\n').filter(line =&gt; line.trim());</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (lines.length &lt; 2) return [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const headers = lines[0].split(',').map(h =&gt; h.trim().replace(/"/g, '').toLowerCase());</p>
<p class="p1"><span class="Apple-converted-space">            </span>const data = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>for (let i = 1; i &lt; lines.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const values = lines[i].split(',').map(v =&gt; v.trim().replace(/"/g, ''));</p>
<p class="p1"><span class="Apple-converted-space">                </span>const row = {};</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>headers.forEach((header, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>row[header] = values[index] || '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const mappedRow = mapColumns(row);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (mappedRow.nome || mappedRow.cognome || mappedRow.email) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>data.push(mappedRow);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>return data;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function parseExcel(arrayBuffer) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const workbook = XLSX.read(arrayBuffer, { type: 'array' });</p>
<p class="p1"><span class="Apple-converted-space">            </span>const firstSheet = workbook.Sheets[workbook.SheetNames[0]];</p>
<p class="p1"><span class="Apple-converted-space">            </span>const jsonData = XLSX.utils.sheet_to_json(firstSheet);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>return jsonData.map(row =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const mappedRow = {};</p>
<p class="p1"><span class="Apple-converted-space">                </span>Object.keys(row).forEach(key =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mappedRow[key.toLowerCase().trim()] = row[key];</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>return mapColumns(mappedRow);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}).filter(row =&gt; row.nome || row.cognome || row.email);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function mapColumns(row) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const mapped = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>nome: '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>cognome: '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>email: ''</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>Object.keys(row).forEach(key =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const lowerKey = key.toLowerCase();</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (lowerKey.includes('nome') || lowerKey.includes('name') || lowerKey === 'first') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mapped.nome = row[key];</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (lowerKey.includes('cognome') || lowerKey.includes('surname') || lowerKey.includes('last')) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mapped.cognome = row[key];</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (lowerKey.includes('email') || lowerKey.includes('mail')) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mapped.email = row[key];</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>return mapped;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showPreview(data) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>pendingImportData = data;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const previewContainer = document.getElementById('preview-container');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const previewTable = document.getElementById('preview-table');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const previewData = data.slice(0, 5);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let tableHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="overflow-x: auto;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;tr style="background: #f8f9fa;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th style="padding: 10px; border: 1px solid #ddd;"&gt;Nome&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th style="padding: 10px; border: 1px solid #ddd;"&gt;Cognome&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th style="padding: 10px; border: 1px solid #ddd;"&gt;Email&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>previewData.forEach(row =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td style="padding: 10px; border: 1px solid #ddd;"&gt;${row.nome || ''}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td style="padding: 10px; border: 1px solid #ddd;"&gt;${row.cognome || ''}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td style="padding: 10px; border: 1px solid #ddd;"&gt;${row.email || ''}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>tableHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="margin-top: 10px; color: #666;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Showing first 5 rows of ${data.length} total records.</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>previewTable.innerHTML = tableHTML;</p>
<p class="p1"><span class="Apple-converted-space">            </span>previewContainer.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function confirmImport() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (pendingImportData &amp;&amp; pendingImportData.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>let importedCount = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const importTimestamp = new Date().toISOString();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>pendingImportData.forEach(row =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (row.email &amp;&amp; !leads.find(l =&gt; l.email === row.email)) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const newLead = {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>id: Date.now() + Math.random(),</p>
<p class="p1"><span class="Apple-converted-space">                            </span>nome: row.nome || '',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>cognome: row.cognome || '',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>email: row.email,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>commerciale: '',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>stato: 'nuovo',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>note: '',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>dataCreazione: importTimestamp,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>ultimaChiamata: null,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>attivita: [</p>
<p class="p1"><span class="Apple-converted-space">                                </span>{</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>azione: 'Creazione lead',</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>stato: 'nuovo',</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>timestamp: importTimestamp,</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>automatico: true,</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>dettagli: 'Lead importato da file CSV/Excel'</p>
<p class="p1"><span class="Apple-converted-space">                                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>]</p>
<p class="p1"><span class="Apple-converted-space">                        </span>};</p>
<p class="p1"><span class="Apple-converted-space">                        </span>leads.unshift(newLead);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>importedCount++;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>showMessage(`✅ Importati con successo ${importedCount} nuovi lead!`, 'success');</p>
<p class="p1"><span class="Apple-converted-space">                </span>cancelImport();</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function cancelImport() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>pendingImportData = null;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('preview-container').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('file-input').value = '';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showMessage(message, type) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const messagesContainer = document.getElementById('import-messages');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const messageClass = type === 'error' ? 'error-message' : 'success-message';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>messagesContainer.innerHTML = `&lt;div class="${messageClass}"&gt;${message}&lt;/div&gt;`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>messagesContainer.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}, 5000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function renderReports() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const reportsContainer = document.getElementById('daily-reports');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate KPIs</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalLeads = leads.length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveredLeads = leads.filter(lead =&gt; lead.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveryRate = totalLeads &gt; 0 ? Math.round((recoveredLeads / totalLeads) * 100) : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const activeLeads = leads.filter(lead =&gt; !['lead-ok', 'non-interessato', 'mai-reperibile'].includes(lead.stato)).length;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update KPI displays</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('total-leads').textContent = totalLeads;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('recovery-rate-percent').textContent = recoveryRate + '%';</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('recovered-leads').textContent = recoveredLeads;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('active-leads').textContent = activeLeads;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate daily call average</p>
<p class="p1"><span class="Apple-converted-space">            </span>const allActivities = leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.filter(a =&gt; a.azione === 'Chiamata effettuata')</p>
<p class="p1"><span class="Apple-converted-space">            </span>);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const daysWithCalls = new Set(allActivities.map(a =&gt; new Date(a.timestamp).toDateString())).size;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const avgDailyCalls = daysWithCalls &gt; 0 ? Math.round(allActivities.length / daysWithCalls) : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('avg-daily-calls').textContent = avgDailyCalls;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update progress bars</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('recovery-bar').style.width = recoveryRate + '%';</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('calls-bar').style.width = Math.min(100, (allActivities.length / 100) * 100) + '%';</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('week-calls').textContent = allActivities.filter(a =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const activityDate = new Date(a.timestamp);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const weekAgo = new Date();</p>
<p class="p1"><span class="Apple-converted-space">                </span>weekAgo.setDate(weekAgo.getDate() - 7);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return activityDate &gt;= weekAgo;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}).length;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate average recovery time</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveredWithDates = leads.filter(lead =&gt; lead.stato === 'lead-ok' &amp;&amp; lead.attivita.length &gt; 1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const avgRecoveryDays = recoveredWithDates.length &gt; 0 ?<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>Math.round(recoveredWithDates.reduce((sum, lead) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const created = new Date(lead.dataCreazione);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const recovered = new Date(lead.attivita.find(a =&gt; a.stato === 'lead-ok')?.timestamp || lead.dataCreazione);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return sum + (recovered - created) / (1000 * 60 * 60 * 24);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 0) / recoveredWithDates.length) : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('avg-recovery-time').textContent = avgRecoveryDays + ' giorni';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Pipeline Stats</p>
<p class="p1"><span class="Apple-converted-space">            </span>const pipelineStatsContainer = document.getElementById('pipeline-stats');</p>
<p class="p1"><span class="Apple-converted-space">            </span>let pipelineHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>Object.keys(statusConfig).forEach(status =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const count = leads.filter(lead =&gt; lead.stato === status).length;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const percentage = totalLeads &gt; 0 ? Math.round((count / totalLeads) * 100) : 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>pipelineHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="margin-bottom: 12px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="display: flex; justify-content: space-between; margin-bottom: 5px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span style="font-size: 0.9em;"&gt;${statusConfig[status].label}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;strong&gt;${count} (${percentage}%)&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="background: #ecf0f1; border-radius: 10px; height: 6px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="background: ${statusConfig[status].color}; height: 6px; border-radius: 10px; width: ${percentage}%;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>pipelineStatsContainer.innerHTML = pipelineHTML;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Pipeline Insights</p>
<p class="p1"><span class="Apple-converted-space">            </span>const insightsContainer = document.getElementById('pipeline-insights');</p>
<p class="p1"><span class="Apple-converted-space">            </span>let insights = [];</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (leads.filter(lead =&gt; lead.stato === 'nuovo').length &gt; 20) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>insights.push('🎯 Molti lead nuovi da processare');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (recoveryRate &gt; 15) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>insights.push('🚀 Ottimo tasso di recupero!');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (recoveryRate &lt; 5) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>insights.push('⚠️ Tasso recupero basso, ottimizzare approach');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (leads.filter(lead =&gt; lead.stato === 'non-risponde-3').length &gt; 10) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>insights.push('📞 Molti lead al 3° tentativo, considerare strategie alternative');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>insightsContainer.innerHTML = insights.length &gt; 0 ? insights.join('&lt;br&gt;') : '✅ Tutto sotto controllo';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Find best performance day</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dailyStats = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>allActivities.forEach(activity =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const date = new Date(activity.timestamp).toDateString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!dailyStats[date]) dailyStats[date] = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>dailyStats[date]++;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const bestDay = Object.keys(dailyStats).reduce((best, date) =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>(!best || dailyStats[date] &gt; dailyStats[best]) ? date : best, null</p>
<p class="p1"><span class="Apple-converted-space">            </span>);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (bestDay) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const bestDayFormatted = new Date(bestDay).toLocaleDateString('it-IT', { weekday: 'short', day: 'numeric', month: 'short' });</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('best-day').textContent = `${bestDayFormatted} (${dailyStats[bestDay]} chiamate)`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Daily activity report (existing functionality)</p>
<p class="p1"><span class="Apple-converted-space">            </span>const activityByDate = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.map(activity =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>...activity,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>leadName: `${lead.nome} ${lead.cognome}`,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>leadEmail: lead.email</p>
<p class="p1"><span class="Apple-converted-space">                </span>}))</p>
<p class="p1"><span class="Apple-converted-space">            </span>).forEach(activity =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const date = new Date(activity.timestamp).toDateString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!activityByDate[date]) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>activityByDate[date] = [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>activityByDate[date].push(activity);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Show last 5 days</p>
<p class="p1"><span class="Apple-converted-space">            </span>const reportHTML = Object.keys(activityByDate)</p>
<p class="p1"><span class="Apple-converted-space">                </span>.sort((a, b) =&gt; new Date(b) - new Date(a))</p>
<p class="p1"><span class="Apple-converted-space">                </span>.slice(0, 5)</p>
<p class="p1"><span class="Apple-converted-space">                </span>.map(date =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const activities = activityByDate[date];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const calls = activities.filter(a =&gt; a.azione === 'Chiamata effettuata');</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>return `</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div style="background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 15px; border-left: 4px solid #3498db;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h4&gt;${new Date(date).toLocaleDateString('it-IT', { weekday: 'long', day: 'numeric', month: 'long' })}&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p style="margin: 10px 0; color: #666;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>📞 &lt;strong&gt;${calls.length} chiamate&lt;/strong&gt; •<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>✅ &lt;strong&gt;${calls.filter(c =&gt; c.stato === 'lead-ok').length} Lead Ok&lt;/strong&gt; •<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>💔 &lt;strong&gt;${calls.filter(c =&gt; c.stato === 'non-interessato' || c.stato === 'mai-reperibile').length} Chiusi&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div style="max-height: 200px; overflow-y: auto; margin-top: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>${activities.slice(0, 8).map(activity =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div style="padding: 5px 0; border-bottom: 1px solid #eee; font-size: 0.8em;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;span style="color: #666;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>${formatTimestamp(activity.timestamp)}</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/span&gt; - &lt;strong&gt;${activity.azione}&lt;/strong&gt; - ${activity.leadName}</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>`).join('')}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>${activities.length &gt; 8 ? `&lt;div style="padding: 5px 0; text-align: center; color: #666; font-size: 0.8em;"&gt;...e altre ${activities.length - 8} attività&lt;/div&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}).join('');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>reportsContainer.innerHTML = reportHTML || '&lt;p&gt;Nessuna attività registrata negli ultimi 5 giorni.&lt;/p&gt;';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function exportLeadOk() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const leadOk = leads.filter(lead =&gt; lead.stato === 'lead-ok');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const csv = 'Nome,Cognome,Email,Commerciale,Note,Data Recupero\n' +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                       </span>leadOk.map(lead =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const dataRecupero = lead.attivita.find(a =&gt; a.stato === 'lead-ok')?.timestamp || '';</p>
<p class="p1"><span class="Apple-converted-space">                           </span>return `${lead.nome},${lead.cognome},${lead.email},${lead.commerciale},"${lead.note}",${new Date(dataRecupero).toLocaleDateString()}`;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>}).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>downloadCSV(csv, `lead-ok-${new Date().toISOString().split('T')[0]}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function exportAllLeads() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const csv = 'Nome,Cognome,Email,Commerciale,Stato,Note,Data Creazione\n' +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                       </span>leads.map(lead =&gt; `${lead.nome},${lead.cognome},${lead.email},${lead.commerciale},${lead.stato},"${lead.note}",${new Date(lead.dataCreazione).toLocaleDateString()}`).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>downloadCSV(csv, `tutti-lead-${new Date().toISOString().split('T')[0]}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function exportActivityLog() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const allActivities = leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.map(activity =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>...activity,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>leadName: `${lead.nome} ${lead.cognome}`,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>leadEmail: lead.email</p>
<p class="p1"><span class="Apple-converted-space">                </span>}))</p>
<p class="p1"><span class="Apple-converted-space">            </span>);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const csv = 'Data,Ora,Lead,Email,Azione,Stato,Dettagli\n' +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                       </span>allActivities.map(activity =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const date = new Date(activity.timestamp);</p>
<p class="p1"><span class="Apple-converted-space">                           </span>return `${date.toLocaleDateString()},${date.toLocaleTimeString()},${activity.leadName},${activity.leadEmail},${activity.azione},${activity.stato},"${activity.dettagli}"`;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>}).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>downloadCSV(csv, `log-attivita-${new Date().toISOString().split('T')[0]}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function exportWeeklyReport() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalLeads = leads.length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveredLeads = leads.filter(lead =&gt; lead.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveryRate = totalLeads &gt; 0 ? Math.round((recoveredLeads / totalLeads) * 100) : 0;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const allActivities = leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.filter(a =&gt; a.azione === 'Chiamata effettuata')</p>
<p class="p1"><span class="Apple-converted-space">            </span>);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const weeklyStats = Object.keys(statusConfig).map(status =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const count = leads.filter(lead =&gt; lead.stato === status).length;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const percentage = totalLeads &gt; 0 ? Math.round((count / totalLeads) * 100) : 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>return `${statusConfig[status].label},${count},${percentage}%`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const csv = `REPORT SETTIMANALE ROMINA - ${new Date().toLocaleDateString()}\n\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`METRICHE GENERALI\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Lead Totali,${totalLeads}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Lead Recuperati,${recoveredLeads}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Tasso Recupero,${recoveryRate}%\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Chiamate Totali,${allActivities.length}\n\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`DISTRIBUZIONE PIPELINE\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Stato,Quantità,Percentuale\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>weeklyStats + '\n\n' +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`ATTIVITA GIORNALIERE\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Data,Chiamate,Lead Ok,Lead Chiusi\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>Object.keys(getActivityByDate()).map(date =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const activities = getActivityByDate()[date];</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const calls = activities.filter(a =&gt; a.azione === 'Chiamata effettuata');</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const leadOk = calls.filter(c =&gt; c.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const leadClosed = calls.filter(c =&gt; c.stato === 'non-interessato' || c.stato === 'mai-reperibile').length;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>return `${new Date(date).toLocaleDateString()},${calls.length},${leadOk},${leadClosed}`;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>}).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>downloadCSV(csv, `report-settimanale-romina-${new Date().toISOString().split('T')[0]}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getActivityByDate() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const activityByDate = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.map(activity =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>...activity,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>leadName: `${lead.nome} ${lead.cognome}`,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>leadEmail: lead.email</p>
<p class="p1"><span class="Apple-converted-space">                </span>}))</p>
<p class="p1"><span class="Apple-converted-space">            </span>).forEach(activity =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const date = new Date(activity.timestamp).toDateString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!activityByDate[date]) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>activityByDate[date] = [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>activityByDate[date].push(activity);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>return activityByDate;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Monthly Management Functions</p>
<p class="p1"><span class="Apple-converted-space">        </span>function showArchiveOptions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const leadOk = leads.filter(lead =&gt; lead.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const nonInteressato = leads.filter(lead =&gt; lead.stato === 'non-interessato').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const maiReperibile = leads.filter(lead =&gt; lead.stato === 'mai-reperibile').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const total = leadOk + nonInteressato + maiReperibile;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('archive-summary').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h4&gt;📊 Summary Lead da Archiviare:&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;✅ Lead Ok: &lt;strong&gt;${leadOk}&lt;/strong&gt; (recuperati con successo)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;💔 Non interessati: &lt;strong&gt;${nonInteressato}&lt;/strong&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;❌ Mai reperibili: &lt;strong&gt;${maiReperibile}&lt;/strong&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;hr style="margin: 10px 0;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;&lt;strong&gt;Totale da archiviare: ${total} lead&lt;/strong&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p style="color: #27ae60;"&gt;Resteranno attivi: &lt;strong&gt;${leads.length - total} lead&lt;/strong&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('archiveModal').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeArchiveModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('archiveModal').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function executeArchive() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const archiveLeadOk = document.getElementById('archive-lead-ok').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const archiveNonInteressato = document.getElementById('archive-non-interessato').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const archiveMaiReperibile = document.getElementById('archive-mai-reperibile').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const exportFirst = document.getElementById('export-before-archive').checked;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>let toArchive = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (archiveLeadOk) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>toArchive = toArchive.concat(leads.filter(lead =&gt; lead.stato === 'lead-ok'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (archiveNonInteressato) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>toArchive = toArchive.concat(leads.filter(lead =&gt; lead.stato === 'non-interessato'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (archiveMaiReperibile) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>toArchive = toArchive.concat(leads.filter(lead =&gt; lead.stato === 'mai-reperibile'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (exportFirst &amp;&amp; toArchive.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Export archived leads</p>
<p class="p1"><span class="Apple-converted-space">                </span>const csv = 'Nome,Cognome,Email,Commerciale,Stato,Note,Data Creazione,Data Archiviazione\n' +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>toArchive.map(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                               </span>`${lead.nome},${lead.cognome},${lead.email},${lead.commerciale},${lead.stato},"${lead.note}",${new Date(lead.dataCreazione).toLocaleDateString()},${new Date().toLocaleDateString()}`</p>
<p class="p1"><span class="Apple-converted-space">                           </span>).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>downloadCSV(csv, `lead-archiviati-${new Date().toISOString().split('T')[0]}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// In real Firebase implementation, move to 'archived_leads' collection</p>
<p class="p1"><span class="Apple-converted-space">            </span>// await addDoc(collection(db, 'archived_leads'), {...lead, dataArchiviazione: new Date()});</p>
<p class="p1"><span class="Apple-converted-space">            </span>// await deleteDoc(doc(db, 'leads', lead.id));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// For demo: remove from current leads array</p>
<p class="p1"><span class="Apple-converted-space">            </span>const archivedIds = toArchive.map(lead =&gt; lead.id);</p>
<p class="p1"><span class="Apple-converted-space">            </span>leads = leads.filter(lead =&gt; !archivedIds.includes(lead.id));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>alert(`✅ Archiviati con successo ${toArchive.length} lead!`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>closeArchiveModal();</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showCleanupOptions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('cleanupModal').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeCleanupModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('cleanupModal').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function executeCleanup() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cleanupAllLeads = document.getElementById('cleanup-all-leads').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cleanupActivityLog = document.getElementById('cleanup-activity-log').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const exportFirst = document.getElementById('export-before-cleanup').checked;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!cleanupAllLeads &amp;&amp; !cleanupActivityLog) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('⚠️ Seleziona almeno un\'opzione di pulizia.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const confirmMessage = `⚠️ ATTENZIONE!\n\nStai per eliminare:\n${cleanupAllLeads ? '- TUTTI i lead\n' : ''}${cleanupActivityLog ? '- Tutti i log di attività\n' : ''}\nQuesta operazione è IRREVERSIBILE!\n\nContinuare?`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!confirm(confirmMessage)) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (exportFirst) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Export everything before cleanup</p>
<p class="p1"><span class="Apple-converted-space">                </span>exportAllLeads();</p>
<p class="p1"><span class="Apple-converted-space">                </span>exportActivityLog();</p>
<p class="p1"><span class="Apple-converted-space">                </span>exportMonthlyReport();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (cleanupAllLeads) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// In real Firebase: delete all documents in 'leads' collection</p>
<p class="p1"><span class="Apple-converted-space">                </span>leads = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (cleanupActivityLog) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// In real Firebase: delete all documents in activity logs</p>
<p class="p1"><span class="Apple-converted-space">                </span>leads.forEach(lead =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>lead.attivita = [{</p>
<p class="p1"><span class="Apple-converted-space">                        </span>azione: 'Sistema ripulito',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>stato: lead.stato,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>timestamp: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">                        </span>automatico: true,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>dettagli: 'Log precedenti eliminati durante pulizia mensile'</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}];</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>alert('🧹 Pulizia completata! Sistema pronto per nuovi lead.');</p>
<p class="p1"><span class="Apple-converted-space">            </span>closeCleanupModal();</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function exportMonthlyReport() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalLeads = leads.length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveredLeads = leads.filter(lead =&gt; lead.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const recoveryRate = totalLeads &gt; 0 ? Math.round((recoveredLeads / totalLeads) * 100) : 0;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const allActivities = leads.flatMap(lead =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>lead.attivita.filter(a =&gt; a.azione === 'Chiamata effettuata')</p>
<p class="p1"><span class="Apple-converted-space">            </span>);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthlyStats = Object.keys(statusConfig).map(status =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const count = leads.filter(lead =&gt; lead.stato === status).length;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const percentage = totalLeads &gt; 0 ? Math.round((count / totalLeads) * 100) : 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>return `${statusConfig[status].label},${count},${percentage}%`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}).join('\n');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate daily performance</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dailyStats = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>allActivities.forEach(activity =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const date = new Date(activity.timestamp).toDateString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!dailyStats[date]) dailyStats[date] = { calls: 0, leadOk: 0, closed: 0 };</p>
<p class="p1"><span class="Apple-converted-space">                </span>dailyStats[date].calls++;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (activity.stato === 'lead-ok') dailyStats[date].leadOk++;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (activity.stato === 'non-interessato' || activity.stato === 'mai-reperibile') dailyStats[date].closed++;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const dailyPerformance = Object.keys(dailyStats)</p>
<p class="p1"><span class="Apple-converted-space">                </span>.sort((a, b) =&gt; new Date(a) - new Date(b))</p>
<p class="p1"><span class="Apple-converted-space">                </span>.map(date =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const stats = dailyStats[date];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return `${new Date(date).toLocaleDateString()},${stats.calls},${stats.leadOk},${stats.closed}`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}).join('\n');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const csv = `REPORT MENSILE COMPLETO ROMINA - ${new Date().toLocaleDateString()}\n\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`PERIODO,${Object.keys(dailyStats).length &gt; 0 ?<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>new Date(Math.min(...Object.keys(dailyStats).map(d =&gt; new Date(d)))).toLocaleDateString() +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>' - ' +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>new Date(Math.max(...Object.keys(dailyStats).map(d =&gt; new Date(d)))).toLocaleDateString()<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>: 'N/A'}\n\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`METRICHE GENERALI\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Lead Totali Processati,${totalLeads}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Lead Recuperati con Successo,${recoveredLeads}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Tasso di Recupero,${recoveryRate}%\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Chiamate Totali Effettuate,${allActivities.length}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Media Chiamate per Lead,${totalLeads &gt; 0 ? (allActivities.length / totalLeads).toFixed(1) : 0}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Giorni di Lavoro,${Object.keys(dailyStats).length}\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Media Chiamate per Giorno,${Object.keys(dailyStats).length &gt; 0 ? (allActivities.length / Object.keys(dailyStats).length).toFixed(1) : 0}\n\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`DISTRIBUZIONE FINALE PIPELINE\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Stato,Quantità,Percentuale\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>monthlyStats + '\n\n' +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`PERFORMANCE GIORNALIERA\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Data,Chiamate,Lead Ok,Lead Chiusi\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>dailyPerformance + '\n\n' +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`COMMERCIALI PERFORMANCE\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>`Commerciale,Lead Assegnati,Lead Ok Ricevuti\n` +</p>
<p class="p1"><span class="Apple-converted-space">                       </span>commerciali.map(comm =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const assigned = leads.filter(lead =&gt; lead.commerciale === comm).length;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>const recovered = leads.filter(lead =&gt; lead.commerciale === comm &amp;&amp; lead.stato === 'lead-ok').length;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>return `${comm},${assigned},${recovered}`;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>}).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>downloadCSV(csv, `report-mensile-completo-${new Date().toISOString().split('T')[0]}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function downloadCSV(csv, filename) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });</p>
<p class="p1"><span class="Apple-converted-space">            </span>const url = window.URL.createObjectURL(blob);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const a = document.createElement('a');</p>
<p class="p1"><span class="Apple-converted-space">            </span>a.href = url;</p>
<p class="p1"><span class="Apple-converted-space">            </span>a.download = filename;</p>
<p class="p1"><span class="Apple-converted-space">            </span>a.click();</p>
<p class="p1"><span class="Apple-converted-space">            </span>window.URL.revokeObjectURL(url);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Event listeners</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('add-lead-form').addEventListener('submit', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>addNewLead();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('search-input').addEventListener('input', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderLeads();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Close modal when clicking outside</p>
<p class="p1"><span class="Apple-converted-space">        </span>window.onclick = function(event) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const leadModal = document.getElementById('leadModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const archiveModal = document.getElementById('archiveModal');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cleanupModal = document.getElementById('cleanupModal');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (event.target == leadModal) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>leadModal.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (event.target == archiveModal) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>archiveModal.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (event.target == cleanupModal) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>cleanupModal.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Drag and drop for file upload</p>
<p class="p1"><span class="Apple-converted-space">        </span>const importArea = document.getElementById('import-area');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>importArea.addEventListener('dragover', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>importArea.classList.add('dragover');</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>importArea.addEventListener('dragleave', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>importArea.classList.remove('dragover');</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>importArea.addEventListener('drop', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>importArea.classList.remove('dragover');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const files = e.dataTransfer.files;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (files.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>processFile(files[0]);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize</p>
<p class="p1"><span class="Apple-converted-space">        </span>renderPipeline();</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateStats();</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
